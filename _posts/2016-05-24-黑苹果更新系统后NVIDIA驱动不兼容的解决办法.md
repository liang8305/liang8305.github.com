---
layout : post
categories: [mac]
tags : [nvidia, 驱动, 黑苹果]
keywords :
excerpt:
---
{% include JB/setup %}


今天手贱升级了mac10.11.6 beta 版本, 结果n卡的驱动无法加载了; 重新安装还提示新版系统不支持; 解压开驱动的安装包`WebDriver-346.03.10f01.pkg`, 里面有个`Distribution` 文件里有段js脚本是检查系统版本的:

```java
function validateSoftware()
{
	var supportedOSVer = "10.11.5";
	var supportedOSBuildVer = "15F34";
	var targetBuild = system.version.ProductBuildVersion; 
	var result = compareBuildVersions(targetBuild, supportedOSBuildVer);

	if (result != 0) 
	{
		var title;
		var msg;
		var osVersionString = system.version.ProductVersion;

		if ((targetBuild.substring(0, 2) == supportedOSBuildVer.substring(0, 2)) &amp;&amp; (result &lt; 0))
		{
			title = system.localizedString("need_os_update_title");
			msg = system.localizedStringWithFormat("need_os_update_message", supportedOSVer, supportedOSBuildVer);

		}
		else
		{
			title = system.localizedString("visit_website_title");
			msg = system.localizedStringWithFormat("visit_website_message", osVersionString, targetBuild);

		}

		my.result.title = title;
		my.result.message = msg;
		my.result.type = "Fatal";

		return false;

	}

	return true;

}

```

那么尝试修改里面的值为'10.11.6' 和 '15G37', 再次安装, 检测可以通过, 但是安装到一半还是报错;  好吧, 既然安装脚本改了不行, 那想办法把系统版本号'10.11.6'改回'10.11.5'行不行? 

系统版本的配置在这个文件里: `/System/Library/CoreServices/System Events.app'`

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
		<key>ProductBuildVersion</key>
		<string>15G37</string>
		<key>ProductCopyright</key>
		<string>1983-2016 Apple Inc.</string>
		<key>ProductName</key>
		<string>Mac OS X</string>
		<key>ProductUserVisibleVersion</key>
		<string>10.11.6</string>
		<key>ProductVersion</key>
		<string>10.11.6</string>
</dict>
</plist>

```
把里面相应的数值修改保存之后, 安装成功; 重启后, 驱动正确加载!

